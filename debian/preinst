#!/bin/sh
# preinst script for wasta-gnome
#
# see:
#   - man deb-preinst
#   - man dh_installdeb(1)

set -e
set -x
case "$1" in
    install|upgrade)
        # Call main preinst script.  Error in that script should NOT stop
        #   preinst from completing.  We want to ensure that the package
        #   installs even if the script fails.
        #   If not, later updates to package won't install either because
        #   the broken version will attempt to keep installing until manually
        #   uninstalled.
        #bash /usr/share/wasta-gnome/wasta-gnome-preinst.sh
        # Auto-select current display-manager to keep.
        DM=$(systemctl show display-manager.service | grep Id= |
            awk -F= '{print $2}' | awk -F'.' '{print $1}')
        echo "gdm3	shared/default-x-display-manager	select	$DM" |\
        	debconf-set-selections
        echo "gdm3	shared/default-x-display-manager seen" |\
        	debconf-set-selections
        debconf-get-selections | grep gdm3
    ;;

    abort-upgrade)
    ;;

    *)
        echo "preinst called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
